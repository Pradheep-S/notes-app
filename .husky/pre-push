#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üöÄ Running pre-push checks..."

# Run tests for all projects
echo "üß™ Running tests..."

# Backend tests
echo "Testing backend..."
cd backend && npm test
if [ $? -ne 0 ]; then
  echo "‚ùå Backend tests failed!"
  exit 1
fi

# Admin tests
echo "Testing admin dashboard..."
cd ../admin && npm test
if [ $? -ne 0 ]; then
  echo "‚ùå Admin tests failed!"
  exit 1
fi

# Mobile tests (only if Flutter is installed)
if command -v flutter >/dev/null 2>&1; then
  echo "Testing mobile app..."
  cd ../mobile && flutter test
  if [ $? -ne 0 ]; then
    echo "‚ùå Mobile tests failed!"
    exit 1
  fi
else
  echo "‚ö†Ô∏è  Flutter not found in PATH, skipping mobile tests"
fi

echo "‚úÖ All pre-push checks passed!"
